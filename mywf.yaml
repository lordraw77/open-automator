- name: 
  tasks:

  - name: check_http
    module: oa-network
    function: httpget
    host: 192.168.0.220
    port: 8123
    get: /
    printout: true
    on_success: db_check
    on_failure: notify_ko

  - name: db_check
    module: oa-pg
    function: select
    pgdatabase: postgres
    pgdbhost: 192.168.0.175
    pgdbusername: ${WALLET:db_user}
    pgdbpassword: ${WALLET:db_password}
    pgdbport: 5432
    statement: "select 1"
    printout: true
    on_success: notify_ok
    on_failure: notify_ko

  - name: notify_ko
    module: oa-notify
    function: sendtelegramnotify
    tokenid: ${WALLET:telegram_token}
    chatid: ["${WALLET:telegram_chatid}"]
    message: "Workflow ko"
    on_success: end

  - name: notify_ok
    module: oa-notify
    function: sendtelegramnotify
    tokenid: ${WALLET:telegram_token}
    chatid: ["${WALLET:telegram_chatid}"]
    message: "Workflow OK"
    printresponse: true
    on_success: end
    # se non metti niente continua lineare oppure puoi mettere on_success: end
